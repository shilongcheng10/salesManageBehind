<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.unicom.salesmanagebehind.dao.SalesDao">
    <resultMap id="BaseResultMap" type="com.unicom.salesmanagebehind.model.Sales">
        <id column="saleId" jdbcType="INT" property="saleId" />
        <result column="salemanId" jdbcType="INT" property="salemanId" />
        <result column="productId" jdbcType="INT" property="productId" />
        <result column="date" jdbcType="DATETIME" property="date" />
        <result column="address" jdbcType="VARCHAR" property="address" />
    </resultMap>
    <resultMap id="BaseResultMap" type="com.unicom.salesmanagebehind.model.Product">
        <id column="productId" jdbcType="INT" property="productId" />
        <result column="productName" jdbcType="VARCHAR" property="productName" />
        <result column="productFee" jdbcType="INT" property="productFee" />
        <result column="recommend" jdbcType="VARCHAR" property="recommend" />
        <result column="description" jdbcType="VARCHAR" property="description" />
        <result column="isFirstPush" jdbcType="INT" property="isFirstPush" />
        <result column="startTime" jdbcType="DATETIME" property="startTime" />
        <result column="endTime" jdbcType="DATETIME" property="endTime" />
        <result column="updateUserId" jdbcType="INT" property="updateUserId" />
        <result column="updateTime" jdbcType="DATETIME" property="updateTime" />
        <result column="imgUrl" jdbcType="VARCHAR" property="imgUrl" />
        <result column="isDelete" jdbcType="INT" property="isDelete" />
    </resultMap>

    <select id="selectDay" parameterType="int" resultMap="int">
        SELECT sum(productFee)
        from product,sales
        WHERE product.productId = sales.productId
        and to_days(sales.date) = to_days(now())
    </select>

    <select id="selectMonth" parameterType="int" resultMap="int">
        SELECT sum(productFee)
        from product,sales
        WHERE product.productId = sales.productId
        and DATE_FORMAT( sales.date, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )

    </select>

    <select id="selectYear" parameterType="int" resultMap="int">
        SELECT sum(productFee)
        from product,sales
        WHERE product.productId = sales.productId
        and YEAR(sales.date)=YEAR(NOW())
    </select>

    <select id="selectProduct"  resultMap="List">
        SELECT productId,COUNT(*)
        from sales
        Group by productId
    </select>

    <select id="selectSaleMan"  resultMap="List">
        SELECT salemanId,COUNT(*)
        from sales
        Group by salemanId
    </select>

</mapper>
